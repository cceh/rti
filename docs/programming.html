

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Programming the AVR-Microcontroller &mdash; RTI 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ptmlib" href="ptmlib.html" />
    <link rel="prev" title="Firmware" href="firmware.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> RTI
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to RTI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#outline">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#the-math">The Math</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="builder.html">Dome Builder Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="design.html">Electrical Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="design.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#choice-of-led">Choice of LED</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#led-driver">Led Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#constant-current-source">Constant Current Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#microcontroller">Microcontroller</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#connectors">Connectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#board-layout">Board Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="design.html#case">Case</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user.html">Dome User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="shooting.html">Shooting Manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#camera-settings">Camera Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#dome-setup">Dome Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#shooting">Shooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#various-notes">Various Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#camera-manuals">Camera Manuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="shooting.html#footnotes">Footnotes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lens_selection.html">Lens Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lens_selection.html#buying-lenses">Buying Lenses</a></li>
<li class="toctree-l3"><a class="reference internal" href="lens_selection.html#object-sizes">Object Sizes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="raw_or_jpeg.html">RAW or JPEG?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="raw_or_jpeg.html#raw">RAW</a></li>
<li class="toctree-l3"><a class="reference internal" href="raw_or_jpeg.html#jpeg">JPEG</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vibrations.html">Vibration Reduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vibrations.html#live-view">Live View</a></li>
<li class="toctree-l3"><a class="reference internal" href="vibrations.html#exposure-delay-mode">Exposure Delay Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="vibrations.html#mirrorless-cameras">Mirrorless Cameras</a></li>
<li class="toctree-l3"><a class="reference internal" href="vibrations.html#footnotes">Footnotes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_scripts.html">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#scripts-image-filer-py">scripts/image-filer.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#scripts-image-converter-py">scripts/image-converter.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#scripts-lp-builder-py">scripts/lp-builder.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#bin-ptm-encoder">bin/ptm-encoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#bin-ptm-decoder">bin/ptm-decoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#bin-ptm-exploder">bin/ptm-exploder</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_scripts.html#sample-lp-file-format">sample.lp file format</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="developer.html">Software Developer Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="firmware.html">Firmware</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Programming the AVR-Microcontroller</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#program-the-microcontroller">Program the Microcontroller</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialize-a-new-microcontroller">Initialize a New Microcontroller</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ptmlib.html">ptmlib</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ptmlib.html#ptmlib-h">ptmlib.h</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RTI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="developer.html">Software Developer Manual</a> &raquo;</li>
        
      <li>Programming the AVR-Microcontroller</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/programming.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="programming-the-avr-microcontroller">
<span id="programming"></span><h1>Programming the AVR-Microcontroller<a class="headerlink" href="#programming-the-avr-microcontroller" title="Permalink to this headline">¶</a></h1>
<p>How to install a new <a class="reference internal" href="firmware.html#firmware"><span class="std std-ref">Firmware</span></a> into the CRM.  To do this you need to
purchase an IPS programmer device.  We recommend the <a class="reference external" href="https://en.wikipedia.org/wiki/AVR_microcontrollers#AVR_Dragon">AVR Dragon</a> device, which
will set you back ~ €60 in Germany.</p>
<p>To program a microcontroller chip that is mounted in the CRM module you need a
6-way ribbon cable.  To program microcontroller chips when they are not yet
mounted, you must solder a socket to the AVR-Dragon and use jumper cables.
Refer to the AVR-Dragon instruction manual.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Install avrdude:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt-get install avrdude</span>
</pre></div>
</div>
<p>If you are not using an AVR-Dragon: Edit the <code class="code docutils literal notranslate"><span class="pre">MY_AVRDUDE</span> <span class="pre">=</span></code> line in the
file <code class="file docutils literal notranslate"><span class="pre">firmware/Makefile</span></code> to suit your ISP programmer.</p>
</div>
<div class="section" id="program-the-microcontroller">
<h2>Program the Microcontroller<a class="headerlink" href="#program-the-microcontroller" title="Permalink to this headline">¶</a></h2>
<p>To program or reprogram a microcontroller chip, when it is already mounted in
the CRM Module:</p>
<ol class="arabic" start="0">
<li><p>Open the case.</p></li>
<li><p>Connect the AVR-Dragon programmer with the CRM Module using a 6-way ribbon
cable.  Make sure to connect pin 1 on the Dragon to pin 1 on the CRM!</p></li>
<li><p>Connect the AVR-Dragon with the PC using an USB cable.</p></li>
<li><p>Connect the power source to the CRM.</p></li>
<li><p>Change into the <code class="file docutils literal notranslate"><span class="pre">firmware</span></code> directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd firmware</span>
</pre></div>
</div>
</li>
<li><p>If this is the first time you prgram this microcontroller <a class="reference internal" href="#c-init"><span class="std std-ref">initialize
it</span></a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">make my_initfuses</span>
</pre></div>
</div>
</li>
<li><p>Program the microcontroller:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">make my_ispload</span>
</pre></div>
</div>
</li>
<li><p>Disconnect the 6-way cable from the CRM, remove the power cord and close the
case.</p></li>
</ol>
</div>
<div class="section" id="initialize-a-new-microcontroller">
<span id="c-init"></span><h2>Initialize a New Microcontroller<a class="headerlink" href="#initialize-a-new-microcontroller" title="Permalink to this headline">¶</a></h2>
<p>To initialize a factory-new microcontroller run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">make my_init_fuses</span>
</pre></div>
</div>
<p>This command only needs to be run once on every microcontroller chip (but it
doesn’t hurt doing it more often).  It tells the microcontroller to use the
external crystal oscillator instead of the internal one.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ptmlib.html" class="btn btn-neutral float-right" title="ptmlib" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="firmware.html" class="btn btn-neutral float-left" title="Firmware" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-18 CCeH - Licensed under the GNU GPL v3 or later

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>